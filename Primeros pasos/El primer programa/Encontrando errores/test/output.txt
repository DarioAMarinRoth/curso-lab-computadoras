Los errores de este c√≥digo se han solucionado.